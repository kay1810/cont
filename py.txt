# Assuming $certInstallationStatus contains the server name and installation status for one server only
# Example: $serverName = "Server1"; $installationStatus = "Success"

# Read server details CSV
$servers = Import-Csv -Path "server_details.csv"

# Find the server in the CSV
$server = $servers | Where-Object { $_.'server name' -eq $serverName }
if ($server -ne $null) {
    # Update the "pending for new cert installation" flag if installation is successful
    if ($installationStatus -eq "Success") {
        $server.'pending for new cert installation' = "No"

        # Update the row in the CSV
        $servers | Export-Csv -Path "server_details.csv" -NoTypeInformation
    }
} else {
    Write-Warning "Server '$serverName' not found in the server details CSV."
}
